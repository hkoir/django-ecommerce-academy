{% extends "../base.html" %}
{% load static %}

{% block stylesheet %}{% static 'store/css/store.css' %}{% endblock %}

{% block title %}

{% if product %}{{ product.title }}{% else %}Product{% endif %}
{% endblock %}






{% block content %}



<style>
  /* The popup Modal start*/
  .modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0, 0, 0); /* Fallback color */
    background-color: rgba(0,0,0,0.3); /* Black w/ opacity */
  }
  
  /* Modal Content/Box */
  .modal-content {
    background-color: cyan;
    margin: 15% auto; /* 15% from the top and centered */
    padding: 10px;
    border: 1px solid #2decec;
    width: 325px; /* Could be more or less, depending on screen size */
    height:190px;
    box-shadow:5px 10px 10px 20px rgba(210, 150, 120, 0.5);
  }
  
  /* The Close Button */
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }
  
  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }
  


  
 /* animated text */
 @keyframes slide {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(0);
  }
}


.adarea{
  animation:  pulsate  ease 2s infinite ;
}

@keyframes fadeIn {
  0% {
    opacity:0;
  }
  100% {
    opacity:1;
  }
}


@keyframes rotate {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}


@keyframes bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-30px);
  }
  60% {
    transform: translateY(-15px);
  }
}



@keyframes pulsate {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}








@keyframes rotate {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes pulsate {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

.adarea {
  animation: rotate 4s linear infinite, pulsate 2s ease-in-out infinite;
}







.hover-zoom {
    transition: transform 0.3s ease-in-out;  /* Add a smooth transition effect */
}
.hover-zoom:hover {
    transform: scale(1.2);  /* Increase the size on hover */
    z-index: 1
}





/* Default styling for larger screens */
.hover-zoom-feature{
  /* Your default styles here */
  width: 300px; /* Adjust the width as needed for larger screens */
  height: 300px;
}

/* Media query for smaller screens */
@media screen and (max-width: 767px) {
  .hover-zoom-feature{
    width: 200px; /* Adjust the width as needed for smaller screens */
    height: 200px
  }
}

/* Default styling for larger screens */
.hover-zoom-small{
  /* Your default styles here */
  width:150px; /* Adjust the width as needed for larger screens */
  height: 150px;
}

/* Media query for smaller screens */
@media screen and (max-width: 767px) {
  .hover-zoom-small{
    width: 100px; /* Adjust the width as needed for smaller screens */
    height: 100px
  }
}



.slick-prev,
.slick-next {
  border: none;
  border-radius: 50%;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: 1;
  cursor: pointer;
  margin:0;
  padding:0;
}

.slick-prev {
  left: 15px;
}

.slick-next {
  right: 35px; 
}

</style>


{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}


<div class="container"><!-- container start -->
        {% if messages %}
        <div class="alert alert-warning" alert-{{ message.tags }}" role="alert">
        {% for message in messages  %}
          {{message|safe}} - <a href="{% url "account:wishlist" %}" class="alert-link">Your Wishlist</a>.
        {% endfor %}
        </div>
        {% endif %}

  <div class="row row-cols-md-2 g-3"><!-- container row start -->
    <!-- column-1 -->
    <div class="col order-md-last p-4 order-1">
      <div class="d-grid gap-2">
        <div class="d-flex d-flex-inline justify-content-between">
          <div><span class="h3">BDT{{ product.regular_price }}</span>
            <p class="text-muted">includes tax</p>
          </div>
          <div>
            <label for="select">Qty</label>
            <select id="select" class="h6 store-select-dropdown">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="1">5</option>
              <option value="2">6</option>
              <option value="3">7</option>
              <option value="4">8</option>
              <option value="3">9</option>
              <option value="4">10</option>
            </select>
            
            <label for="select">Size</label>
            <select id="select{{product.id}}"class="h6 store-select-dropdown">               
                  <option value="" selected disabled hidden>{{item.size}}</option>
                  <option value="">S</option>
                  <option value="">M</option>
                  <option value="">L</option>
                  <option value="">XL</option>
              </select>
          </div>
        </div>
        <hr>
        <button type="button" id="add-button" value="{{product.id}}" class="btn btn-success fw500">
          Add to basket</button>
        <a href="{% url "account:user_wishlist" product.id  %}" class="btn btn-success fw500" role="button" aria-disabled="true">
          Add to Wish List</a>
      </div>
   
    </div>

   <!-- column-2 -->
<div class="col">
  <div class="card mb-3 border-0">
      <div class="row g-0">
          <div class="col-md-12">
              <div class="card-body p-1">
                  <h1 class="mb-0 h2 pe-4 pb-4">{{ product.title }}</h1>
                  <div class="bg-light">
                      {% for image in product.product_image.all %}
                          {% if image.is_feature %}
                              <!-- Feature Image Display -->
                              <div class="d-flex justify-content-center align-items-center">
                                  <img class="img-fluid mx-auto d-block hover-zoom-feature hover-zoom"  alt="Responsive image"
                                      src="{{ image.image.url }}" alt="{{ image.image.alt_text }}">
                                  {% if product.video %}
                                      <video class="img-fluid mx-auto d-block hover-zoom-feature hover-zoom" controls style="margin-left: 20px;">
                                          <source src="{{ product.video.url }}" type="video/mp4">
                                          Your browser does not support the video tag.
                                      </video>
                                  {% endif %}
                              </div>
                              <div>
                                  <a href="{% url 'store:product-reviews' slug=product.slug %}" role="button"
                                      style="text-decoration: none;">
                                      {% if product.stars %}
                                          <p class="my-3" style="font-size: 20px; text-align: center;">Reviews:{{ product.stars }}</p>
                                      {% endif %}
                                  </a>
                              </div>
                          {% endif %}
                      {% endfor %}

                      <!-- Slick Carousel for non-feature images -->
                      <div class="slick-carousel">
                          {% for image in product.product_image.all %}
                              {% if not image.is_feature %}
                                  <div>
                                      <img class="img-fluid d-block-inline pt-3 hover-zoom-small hover-zoom" alt="Responsive image" src="{{ image.image.url }}" alt="{{ image.image.alt_text }}">
                                  </div>
                              {% endif %}
                          {% endfor %}
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
</div> <!-- end of row -->
</div><!-- end of container -->


<div class="container">
  <div class="row">
    <div class="col">      
        <h3>Description</h3> 
        {{ product.description }}
        <h3>Specification:</h3>
        {% for spec in specifications %}
        <h6>{{ spec.specification.name }}:</h6>{{ spec.value }}
        {% endfor %}<br>  

        {% for image in product.product_image.all %}
     
        <img class="img-fluid d-block-inline pt-3 hover-zoom" width="300px" alt="Responsive image"
        src="{{ image.image.url }}" alt="{{ image.image.alt_text }}" >
      
        {% endfor %}  
    </div>
  </div>
</div>


  <!-- <h1> modal</h1>  -->
  <div class="container">
    <div class="row">
      <div class="col-4"></div>
          <div class="col-4">

            <!-- <button id="myBtn" class="btn btn-primary ">Open Modal</button> -->

            <div id="myModal" class="modal"> 
              <div class="modal-content">
                  <span class="close">&times;</span>
                  <p>Thank you. Your product has been added into your Basket</p>                          
                   <div class="modal-footer">
                      <button id="cancel" type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                      <button id="ok" type="submit" class="btn btn-primary">OK</button>
                    </div>  
                </div>
              </div> 
            </div>
  
      <div class="col-4"></div>
  
    </div>
  </div>


  

  <script>
    $(document).on('click', '#add-button', function (e) {
      e.preventDefault();
      $.ajax({
        type: 'POST',
        url: '{% url "basket:basket_add" %}',
        data: {
          productid: $('#add-button').val(),
          productqty: $('#select option:selected').text(),
          csrfmiddlewaretoken: "{{csrf_token}}",
          action: 'post'
        },
        success: function (json) {
          document.getElementById("basket-qty").innerHTML = json.qty
        },
        error: function (xhr, errmsg, err) {}
      });
    })



//Modals for popup
var modal = document.getElementById("myModal");
var btn = document.getElementById("add-button");
var span = document.getElementsByClassName("close")[0];

var cancelButton = document.getElementById("cancel");
var okButton = document.getElementById("ok");

btn.onclick = function() {
  modal.style.display = "block";
};
span.onclick = function() {
  modal.style.display = "none";
};
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
};

cancelButton.onclick = function(){
  modal.style.display= "none";
}
okButton.onclick = function(){
  modal.style.display="none"
};

setTimeout(function() {
    modal.style.display = 'none';
  }, 5000);



    // Initialize Slick Carousel
    $(document).ready(function(){
        $('.slick-carousel').slick({
            slidesToShow: 3, // Adjust the number of visible items
            slidesToScroll: 1,
            autoplay: true,
            autoplaySpeed: 2000, // Adjust the speed of the carousel
            // prevArrow: '<button type="button" class="slick-prev">Previous</button>',
            // nextArrow: '<button type="button" class="slick-next">Next</button>',
        });
    });



  </script>

  {% endblock %}